{
  "MaxConcurrent": {
    "Computers": 10,
    "FoldersPerMatrix": 3,
    "JobsPerRemoteComputer": 3
  },
  "Matrix": {
    "FolderPath": "C:\\Permission matrix files",
    "DefaultsFile": "C:\\Permission matrix files\\Defaults.xlsx",
    "Archive": false,
    "ExcludedSamAccountName": ["cnorris"]
  },
  "Export": {
    "FormDataExcelFile": "C:\\ServiceNow\\FromData.xlsx",
    "OverviewHtmlFile": "C:\\reports\\Overview.html",
    "PermissionsExcelFile": "C:\\reports\\Permissions.xlsx",

    "FolderPath": "C:\\ServiceNow",
    "FileName": {
      "AdObjects": "AdObjectNames.csv",
      "FormData": "FormData.csv",
      "GroupManagers": "GroupManagers.csv",
      "AccessList": "AccessList.csv",
      "Overview": {
        "ExcelExportOverview": "ExportOverview.xlsx",
        "HtmlMatrixOverview": "MatrixOverview.html"
      }
    }
  },
  "ServiceNow": {
    "CredentialsFilePath": "C:\\PasswordsServiceNow.json",
    "Environment": "Prod",
    "TableName": "u_bnl_roles"
  },
  "PSSessionConfiguration": "PowerShell.7",
  "Settings": {
    "ScriptName": "Permission matrix",
    "SendMail": {
      "When": "always",
      "From": "no-reply-bnl-automation@heidelbergmaterials.com",
      "FromDisplayName": "Move file over SFTP (TEST Brecht)",
      "To": ["brecht.gijbels@heidelbergmaterials.com"],
      "Bcc": [],
      "Subject": "TEST Brecht",
      "Body": "Transfer files using SFTP from a source to a destination folder.",
      "Smtp": {
        "ServerName": "DEUNonAuthSMTP.GROUPHC.NET",
        "Port": 25,
        "ConnectionType": "None",
        "UserName": "",
        "Password": ""
      },
      "AssemblyPath": {
        "MailKit": "ENV:MAILKIT_DLL",
        "MimeKit": "ENV:MIMEKIT_DLL"
      }
    },
    "SaveLogFiles": {
      "Detailed": true,
      "Where": {
        "Folder": "\\\\BELSGFRANIT07\\Log\\File or folder\\Permission matrix\\Permission matrix (BNL)"
      },
      "DeleteLogsAfterDays": 30
    },
    "SaveInEventLog": {
      "Save": true,
      "LogName": "HCScripts"
    }
  },
  "?": {
    "MaxConcurrent": {
      "Computers": "(Mandatory) Maximum quantity of unique computer names that can be requested to perform jobs at the same time.",
      "FoldersPerMatrix": "(Mandatory) Maximum quantity of folders to iterate at the same time within a single job running on a remote computer.",
      "JobsPerRemoteComputer": "(Mandatory) Maximum quantity of jobs to run at the same time on a single remote computer."
    },
    "Matrix": {
      "FolderPath": "(Mandatory) The folder path where the matrix Excel files are located.",
      "DefaultsFile": "(Mandatory) An Excel file containing general settings that apply to all matrix files. This file contains the worksheet 'Permissions', responsible for setting default permissions for all matrixes; and the worksheet 'MailTo', containing the e-mail addresses of users that need to receive the report on the results.",
      "Archive": "(Mandatory) Whether to move processed matrix files to the folder 'Archive' in the ImportDir folder. Possible values: true or false.",
      "ExcludedSamAccountName": "(Optional) A list of AD SamAccountNames that will be excluded when checking for group memberships. These accounts are usually used as a place holder, so there are no empty groups in AD."
    },
    "Export": {
      "FolderPath": "(Optional) The path to the folder where to save the csv files. These files are used by ticketing tools to create an interactive form containing the SamAccountName and other fields so end users can easily select the AD objects that are generated by a matrix file.",
      "FileName": {
        "AdObjects": "(Mandatory) The name of the csv file containing the AD object names generated by the combination of GroupName and SiteCode in the settings rows, combined with the headers in the permissions worksheet.",
        "FormData": "(Mandatory) The data used to create the user input form in the ticketing tool.",
        "GroupManagers": "(Mandatory) The name of the csv file containing the group managers for all matrix files.",
        "AccessList": "(Mandatory) The name of the csv file containing the access list for all matrix files.",
        "ExcelOverview": "(Mandatory) The log name of the Excel file containing the same data as the csv files."
      }
    },
    "PSSessionConfiguration": "(Optional) The PowerShell version of the remote endpoint. This value corresponds to the output of the Get-PSSessionConfiguration cmdlet. The minimum supported version is 'PowerShell.7'. Defaults to 'PowerShell.7' if not specified.",
    "Settings": {
      "ScriptName": "(Mandatory) Name of the script, used in the log files and in the event logs.",
      "SendMail": {
        "When": "(Mandatory) Specifies when to send an email notification. Possible values: 'OnError' - Send email only when a system error or an action error occurs; 'OnErrorOrAction' - Send email when the script performed actions or when errors occurred; 'Always' - Send email when the script is finished, regardless of success or failure; 'Never' - Do not send email.",
        "From": "(Mandatory) The sender's email address. Supports environment variables (e.g., 'ENV:MAIL_FROM_ADDRESS').",
        "FromDisplayName": "(Optional) The display name to show for the sender. Email clients may display this differently. It is most likely to be shown if the sender's email address is not recognized (e.g., not in the address book). Supports environment variables (e.g., 'ENV:MAIL_FROM_DISPLAY_NAME').",
        "To": "(Mandatory 'To' or 'Bcc') An array of recipient email addresses. The script will send an email to all addresses in the array.",
        "Bcc": "(Mandatory 'To' or 'Bcc') An array of BCC email addresses.",
        "Subject": "(Optional) The subject line of the email. Default value: 'N actions, N errors'",
        "Body": "(Optional) The HTML body of the email. Default value: A summary table with action and error count.",
        "Smtp": {
          "ServerName": "(Mandatory) The hostname or IP address of the SMTP server. Supports environment variables (e.g., 'ENV:SMTP_SERVER').",
          "Port": "(Mandatory) The port number of the SMTP server. Possible values: 25, 465, 587, 2525. Supports environment variables (e.g., 'ENV:SMTP_PORT').",
          "ConnectionType": "(Optional) The connection type for the SMTP server. Possible values: 'None' - No encryption; 'Auto' - Attempt TLS, fall back to unencrypted; 'SslOnConnect' - Use SSL from the beginning; 'StartTls' - Start with unencrypted, then upgrade to TLS; 'StartTlsWhenAvailable' - Start with unencrypted, upgrade to TLS if supported. Default value: 'None'. Supports environment variables (e.g., 'ENV:SMTP_CONNECTION_TYPE').",
          "UserName": "(Optional) The username for authenticating with the SMTP server. If undefined or NULL, no authentication is attempted. Supports environment variables (e.g., 'ENV:SMTP_USERNAME').",
          "Password": "(Optional) The password for authenticating with the SMTP server. If undefined or NULL, no authentication is attempted. Supports environment variables (e.g., 'ENV:SMTP_PASSWORD')."
        },
        "AssemblyPath": {
          "?": "To use email functionality, install the following packages: 'Install-Package -Name 'MailKit' -Source 'https:\\www.nuget.org/api/v2' -Scope 'AllUsers' -SkipDependencies' and 'Install-Package -Name 'MimeKit' -Source 'https:\\www.nuget.org/api/v2' -Scope 'AllUsers' -SkipDependencies'",
          "MailKit": "(Mandatory) Path to the MailKit.dll assembly. Supports environment variables (e.g., 'ENV:MAILKIT_ASSEMBLY').",
          "MimeKit": "(Mandatory) Path to the MimeKit.dll assembly. Supports environment variables (e.g., 'ENV:MIMEKIT_ASSEMBLY')."
        }
      },
      "SaveLogFiles": {
        "Detailed": "(Mandatory) When set to true, the script logs granular details for troubleshooting incorrect Access Control Lists (ACLs). In addition to the folder path, it reports both the current and expected ACL settings. Due to a significant decrease in performance, this setting should only be enabled when investigating specific issues. Possible values: true or false.",
        "What": {
          "SystemErrors": "(Mandatory) Whether to log execution errors, incorrect input file errors, etc. Possible values: true or false.",
          "AllActions": "(Mandatory) Whether to log all actions performed by the script, including errors. Possible values: true or false.",
          "OnlyActionErrors": "(Mandatory) Whether to log only actions that failed. Possible values: true or false."
        },
        "Where": {
          "Folder": "(Mandatory) The path to the folder where log files will be created. Value '..\\\\Logs': Path relative to the script. Value 'C:\\\\MyApp\\\\Logs': An absolute path. If not specified or NULL, no log files will be created. Supports environment variables (e.g., 'ENV:LOG_FOLDER').",
          "FileExtensions": "(Mandatory) An array of file extensions for the log files (e.g., ['.csv'], ['.json'], ['.txt'], ['.xlsx']). Multiple values are supported. Ignored when Folder is NULL. To use '.xlsx', install the following PowerShell modules 'Install-Module ImportExcel'."
        },
        "DeleteLogsAfterDays": "(Optional) The number of days to keep log files. Log files older than this value (based on their last write time) will be removed from the log folder specified in 'SaveLogFiles.Where.Folder'. If not specified or 0, logs will be kept indefinitely. CAUTION: Ensure the 'SaveLogFiles.Where.Folder' is specifically designated for log files to avoid unintended deletion of other files."
      },
      "SaveInEventLog": {
        "Save": "(Mandatory) Whether to log messages to the Windows event log. Possible values: true or false.",
        "LogName": "(Mandatory) The name of the event log to write to (e.g., 'Application', 'System', or a custom log name like 'Scripts'). Supports environment variables (e.g., 'ENV:EVENT_LOG_NAME')."
      }
    }
  }
}
