{
  "MaxConcurrent": {
    "Computers": 10,
    "FoldersPerMatrix": 3,
    "JobsPerRemoteComputer": 3
  },
  "Matrix": {
    "FolderPath": "C:\\Permission matrix files",
    "DefaultsFile": "C:\\Permission matrix files\\Defaults.xlsx",
    "Archive": false,
    "ExcludedSamAccountName": ["cnorris"]
  },
  "Export": {
    "ServiceNowFormDataExcelFile": "C:\\ServiceNow\\FromData.xlsx",
    "OverviewHtmlFile": "C:\\reports\\Overview.html",
    "PermissionsExcelFile": "C:\\reports\\Permissions.xlsx"
  },
  "ServiceNow": {
    "CredentialsFilePath": "C:\\PasswordsServiceNow.json",
    "Environment": "Prod",
    "TableName": "u_bnl_roles"
  },
  "PSSessionConfiguration": "PowerShell.7",
  "Settings": {
    "ScriptName": "Permission matrix",
    "SendMail": {
      "From": "no-reply-bnl-automation@example.com",
      "FromDisplayName": "Permission matrix",
      "To": ["bob@example.com"],
      "Bcc": [],
      "Subject": "",
      "Body": "Set permissions on files and folders based on an Excel input file.",
      "Smtp": {
        "ServerName": "SERVER1.EXAMPLE.COM",
        "Port": 25,
        "ConnectionType": "None",
        "UserName": "",
        "Password": ""
      },
      "AssemblyPath": {
        "MailKit": "C:\\Program Files\\PackageManagement\\NuGet\\Packages\\MailKit.4.13.0\\lib\\net8.0\\MailKit.dll",
        "MimeKit": "C:\\Program Files\\PackageManagement\\NuGet\\Packages\\MimeKit.4.13.0\\lib\\net8.0\\MimeKit.dll"
      }
    },
    "SaveLogFiles": {
      "Detailed": true,
      "Where": {
        "Folder": "C:\\Log\\File or folder\\Permission matrix"
      },
      "DeleteLogsAfterDays": 30
    },
    "SaveInEventLog": {
      "Save": true,
      "LogName": "Scripts"
    }
  },
  "?": {
    "MaxConcurrent": {
      "Computers": "(Mandatory) Maximum quantity of unique computer names that can be requested to perform jobs at the same time.",
      "FoldersPerMatrix": "(Mandatory) Maximum quantity of folders to iterate at the same time within a single job running on a remote computer.",
      "JobsPerRemoteComputer": "(Mandatory) Maximum quantity of jobs to run at the same time on a single remote computer."
    },
    "Matrix": {
      "FolderPath": "(Mandatory) The folder path where the matrix Excel files are located.",
      "DefaultsFile": "(Mandatory) An Excel file containing general settings that apply to all matrix files. This file contains the worksheet 'Permissions', responsible for setting default permissions for all matrixes; and the worksheet 'MailTo', containing the e-mail addresses of users that need to receive the report on the results.",
      "Archive": "(Mandatory) Whether to move processed matrix files to the folder 'Archive' in the ImportDir folder. Possible values: true or false.",
      "ExcludedSamAccountName": "(Optional) A list of AD SamAccountNames that will be excluded when checking for group memberships. These accounts are usually used as a place holder, so there are no empty groups in AD."
    },
    "Export": {
      "ServiceNowFormDataExcelFile": "(Optional) The path where to save the file that contains the data to upload to the ServiceNow ticketing tool.",
      "OverviewHtmlFile": "(Optional) The path where the html file will be saved that contains an overview of the processed matrix files.",
      "PermissionsExcelFile": "(Optional) The path where to save the Excel file that contains the active directory groups and users used in the matrix files."
    },
    "PSSessionConfiguration": "(Optional) The PowerShell version of the remote endpoint. This value corresponds to the output of the Get-PSSessionConfiguration cmdlet. The minimum supported version is 'PowerShell.7'. Defaults to 'PowerShell.7' if not specified.",
    "Settings": {
      "ScriptName": "(Mandatory) Name of the script, used in the log files and in the event logs.",
      "SendMail": {
        "From": "(Mandatory) The sender's email address. Supports environment variables (e.g., 'ENV:MAIL_FROM_ADDRESS').",
        "FromDisplayName": "(Optional) The display name to show for the sender. Email clients may display this differently. It is most likely to be shown if the sender's email address is not recognized (e.g., not in the address book). Supports environment variables (e.g., 'ENV:MAIL_FROM_DISPLAY_NAME').",
        "To": "(Mandatory 'To' or 'Bcc') An array of recipient email addresses. The script will send an email to all addresses in the array.",
        "Bcc": "(Mandatory 'To' or 'Bcc') An array of BCC email addresses.",
        "Subject": "(Optional) The subject line of the email. Default value: 'N actions, N errors'",
        "Body": "(Optional) The HTML body of the email. Default value: A summary table with action and error count.",
        "Smtp": {
          "ServerName": "(Mandatory) The hostname or IP address of the SMTP server. Supports environment variables (e.g., 'ENV:SMTP_SERVER').",
          "Port": "(Mandatory) The port number of the SMTP server. Possible values: 25, 465, 587, 2525. Supports environment variables (e.g., 'ENV:SMTP_PORT').",
          "ConnectionType": "(Optional) The connection type for the SMTP server. Possible values: 'None' - No encryption; 'Auto' - Attempt TLS, fall back to unencrypted; 'SslOnConnect' - Use SSL from the beginning; 'StartTls' - Start with unencrypted, then upgrade to TLS; 'StartTlsWhenAvailable' - Start with unencrypted, upgrade to TLS if supported. Default value: 'None'. Supports environment variables (e.g., 'ENV:SMTP_CONNECTION_TYPE').",
          "UserName": "(Optional) The username for authenticating with the SMTP server. If undefined or NULL, no authentication is attempted. Supports environment variables (e.g., 'ENV:SMTP_USERNAME').",
          "Password": "(Optional) The password for authenticating with the SMTP server. If undefined or NULL, no authentication is attempted. Supports environment variables (e.g., 'ENV:SMTP_PASSWORD')."
        },
        "AssemblyPath": {
          "?": "To use email functionality, install the following packages: 'Install-Package -Name 'MailKit' -Source 'https:\\www.nuget.org/api/v2' -Scope 'AllUsers' -SkipDependencies' and 'Install-Package -Name 'MimeKit' -Source 'https:\\www.nuget.org/api/v2' -Scope 'AllUsers' -SkipDependencies'",
          "MailKit": "(Mandatory) Path to the MailKit.dll assembly. Supports environment variables (e.g., 'ENV:MAILKIT_ASSEMBLY').",
          "MimeKit": "(Mandatory) Path to the MimeKit.dll assembly. Supports environment variables (e.g., 'ENV:MIMEKIT_ASSEMBLY')."
        }
      },
      "SaveLogFiles": {
        "Detailed": "(Mandatory) When set to true, the script logs granular details for troubleshooting incorrect Access Control Lists (ACLs). In addition to the folder path, it reports both the current and expected ACL settings. Due to a significant decrease in performance, this setting should only be enabled when investigating specific issues. Possible values: true or false.",
        "Where": {
          "Folder": "(Mandatory) The path to the folder where log files will be created. Value '..\\\\Logs': Path relative to the script. Value 'C:\\\\MyApp\\\\Logs': An absolute path. If not specified or NULL, no log files will be created. Supports environment variables (e.g., 'ENV:LOG_FOLDER')."
        },
        "DeleteLogsAfterDays": "(Optional) The number of days to keep log files. Log files older than this value (based on their last write time) will be removed from the log folder specified in 'SaveLogFiles.Where.Folder'. If not specified or 0, logs will be kept indefinitely. CAUTION: Ensure the 'SaveLogFiles.Where.Folder' is specifically designated for log files to avoid unintended deletion of other files."
      },
      "SaveInEventLog": {
        "Save": "(Mandatory) Whether to log messages to the Windows event log. Possible values: true or false.",
        "LogName": "(Mandatory) The name of the event log to write to (e.g., 'Application', 'System', or a custom log name like 'Scripts'). Supports environment variables (e.g., 'ENV:EVENT_LOG_NAME')."
      }
    }
  }
}
